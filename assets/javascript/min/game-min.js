$(document).ready(function(){function e(){$.each(m.charactersArray,function(e,a){$("#instructions").html("Choose a character");var t=$("<div>").attr("id",e).addClass("character");$("<p class='strong mb-0'>").html(a.name).appendTo(t),$("<img>").attr("src",a.image).addClass("img-fluid").appendTo(t);var n=$("<ul>").addClass("stats"),r=$("<li>").append("<span>").addClass("hp").prepend("Health: "),i=$("<li>").append("<span>").addClass("attack").prepend("Attack: "),s=$("<li>").append("<span>").addClass("counter-attack").prepend("Counter Attack: ");$(n).append(r).appendTo(t),$(t).appendTo("#characters")}),a(m.charactersArray)}function a(e){function a(e){var a="#"+e.id;$(a).find(".hp span").html(e.hp),$(a).find(".attack span").html(e.attack),$(a).find(".counter-attack span").html(e.counterAttack)}Array.isArray(e)?$.each(e,function(e,t){a(t)}):a(e)}function t(e){e=parseInt(e),$("#"+e).addClass("me");var a=m.enemies;$.each(a,function(e,a){$("#"+a.id).addClass("enemy")})}function n(){$("#"+m.enemyFighting.id).addClass("fighting"),$("#message").empty()}function r(e){$("#message").html(e)}function i(){$("#message").append("<br> You defeated everyone!!"),$("#reset").addClass("show"),$("#attack").addClass("hide")}function s(e){$("#message").append("<br>You defeated "+e+". Pick your next opponent!")}function c(){$("#"+m.enemyFighting.id).show(),$(".character").removeClass("enemy defeated fighting me"),$("#reset").removeClass("show"),$("#attack").removeClass("hide"),$("#message").empty()}function h(){var e=$(this).attr("id");if(e=parseInt(e),1===m.gameStage){if(m.playerCharacter.id===e)return console.log("you can't fight yourself"),!1;m.selectOpponent(e),n(),m.gameStage=2}0===m.gameStage&&(m.selectCharacter(e),t(e),m.gameStage=1)}function o(){m.attack()}function g(){m.reset(),a(m.charactersArray)}var m={charactersArray:[{name:"Ginny Weasley",hp:120,attack:15,counterAttack:8,image:"./assets/images/ginny.jpg",id:0},{name:"Neville Longbottom",hp:150,attack:20,counterAttack:15,image:"./assets/images/neville.jpg",id:1},{name:"Luna Lovegood",hp:180,attack:25,counterAttack:15,image:"./assets/images/luna.jpg",id:2},{name:"Colin Creevy",hp:100,attack:10,counterAttack:5,image:"./assets/images/colin.jpg",id:3}],gameStage:0,playerCharacter:{},enemies:[],enemyFighting:"",selectCharacter:function(e){var a=this,t=[],n;$.each(this.charactersArray,function(r,i){r===e?n=$.extend(!0,{},a.charactersArray[r]):t.push($.extend(!0,{},a.charactersArray[r]))}),this.playerCharacter=n,this.enemies=t},selectOpponent:function(e){thisGame=this,$.each(thisGame.enemies,function(a,t){e===t.id&&(thisGame.enemyFighting=t)})},attack:function(){var e=this;if(2===e.gameStage){var t=e.playerCharacter.attack,n=e.enemyFighting.counterAttack;e.enemyFighting.hp-=t,e.playerCharacter.hp-=n,e.playerCharacter.attack+=e.charactersArray[e.playerCharacter.id].attack,r("Your hit "+e.enemyFighting.name+" for -"+t+"<br>"+e.enemyFighting.name+" hit you for -"+n),e.enemyFighting.hp<=0&&this.win(),e.playerCharacter.hp<=0&&this.lose(),a(e.enemies),a(e.playerCharacter)}},win:function(){$("#"+m.enemyFighting.id).addClass("defeated").removeClass("fighting");var e=0;$.each(m.enemies,function(a,t){t.hp<0&&(t.hp=0),e+=t.hp}),e<=0?i():s(this.enemyFighting.name),m.gameStage=1},lose:function(){console.log("you lose"),m.reset()},reset:function(){m.gameStage=0,m.playerCharacter="",m.enemies=[],m.enemyFighting="",c()}};e(),$(".character").click(h),$("#attack").click(o),$("#reset").click(g)});